/* ===== RESET & VARIABLES ===== */
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}

:root{
  --bg:#0A0A14;
  --bg-card:#161625;
  --bg-input:#1A1A2E;
  --primary:#6C63FF;
  --primary-light:#8B83FF;
  --primary-glow:rgba(108,99,255,.4);
  --green:#00E676;
  --yellow:#FFD600;
  --red:#FF3D71;
  --text:#E8E8F0;
  --text-m:#7A7A96;
  --text-d:#44445A;
  --border:rgba(108,99,255,.12);
  --border-l:rgba(255,255,255,.04);
  --shadow:0 8px 32px rgba(0,0,0,.5);
  --r:16px;--rs:12px;
  --font:'Inter',-apple-system,BlinkMacSystemFont,sans-serif;
  --st:env(safe-area-inset-top,0px);
  --sb:env(safe-area-inset-bottom,0px);
}
html,body{height:100%;overflow:hidden}
body{font-family:var(--font);background:var(--bg);color:var(--text);-webkit-font-smoothing:antialiased}

/* ===== SCREEN SYSTEM ===== */
.screen{position:fixed;inset:0;z-index:10;overflow-y:auto}

/* ===== SPLASH ===== */
.splash{display:flex;flex-direction:column;align-items:center;justify-content:center;background:var(--bg);z-index:9999;animation:splashIn .6s ease}
.splash__icon{width:80px;height:80px;margin-bottom:24px;animation:splashPulse 2s ease-in-out infinite}
.splash__icon svg{width:100%;height:100%}
.splash__title{font-size:28px;font-weight:800;letter-spacing:-.5px;margin-bottom:6px}
.splash__sub{font-size:14px;color:var(--text-m)}
@keyframes splashIn{0%{opacity:0;transform:scale(.9)}100%{opacity:1;transform:scale(1)}}
@keyframes splashPulse{0%,100%{transform:scale(1)}50%{transform:scale(1.08)}}

/* ===== WELCOME ===== */
.welcome{display:flex;flex-direction:column;background:var(--bg);padding:0 24px;padding-top:var(--st)}
.welcome__hero{flex:1;display:flex;align-items:center;justify-content:center;min-height:0}
.welcome__map-preview svg{width:200px;height:200px}
.welcome__content{padding-bottom:calc(40px + var(--sb));text-align:center}
.welcome__title{font-size:26px;font-weight:800;margin-bottom:10px}
.welcome__desc{font-size:15px;color:var(--text-m);line-height:1.6;margin-bottom:28px;max-width:320px;margin-left:auto;margin-right:auto}
.welcome__login-link{font-size:14px;color:var(--text-m);margin-top:16px}
.welcome__login-link a{color:var(--primary-light);text-decoration:none;font-weight:600}
.welcome__skip{display:block;font-size:14px;color:var(--text-d);text-decoration:none;margin-top:12px;transition:color .2s}
.welcome__skip:hover,.welcome__skip:active{color:var(--text-m)}

/* ===== AUTH SCREENS ===== */
.auth-screen{display:flex;flex-direction:column;background:var(--bg);padding:0 24px;padding-top:calc(16px + var(--st))}
.auth-screen__body{flex:1;display:flex;flex-direction:column;justify-content:center;max-width:400px;width:100%;margin:0 auto}
.auth-screen__title{font-size:28px;font-weight:800;margin-bottom:6px}
.auth-screen__sub{font-size:14px;color:var(--text-m);margin-bottom:28px}
.auth-screen__switch{font-size:14px;color:var(--text-m);text-align:center;margin-top:20px}
.auth-screen__switch a{color:var(--primary-light);text-decoration:none;font-weight:600}
.auth-screen__skip{display:block;font-size:14px;color:var(--text-d);text-decoration:none;text-align:center;margin-top:12px;transition:color .2s}
.auth-screen__skip:hover,.auth-screen__skip:active{color:var(--text-m)}

/* ===== AUTH ERROR ===== */
.auth-error{display:none;padding:12px 16px;background:rgba(255,61,113,.1);border:1px solid rgba(255,61,113,.25);border-radius:var(--rs);color:var(--red);font-size:13px;font-weight:500;line-height:1.5;margin-bottom:4px;animation:fadeSlideUp .25s ease}
.auth-error.active{display:block}

/* ===== DELETE ACCOUNT ===== */
.settings-item--danger{color:var(--red)}
.settings-item--danger svg{color:var(--red)}

.screen-back{position:absolute;top:calc(16px + var(--st));left:16px;width:40px;height:40px;border-radius:50%;border:1px solid var(--border);background:rgba(22,22,37,.8);color:var(--text);display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:5;backdrop-filter:blur(8px)}
.screen-back svg{width:20px;height:20px}

/* ===== FORMS ===== */
.auth-form{display:flex;flex-direction:column;gap:16px}
.auth-form__forgot{font-size:13px;color:var(--primary-light);text-decoration:none;text-align:right;margin-top:-8px}
.form-field{display:flex;flex-direction:column;gap:6px}
.form-field__label{font-size:13px;font-weight:600;color:var(--text-m)}
.form-field__input{padding:14px 16px;background:var(--bg-input);border:1px solid var(--border);border-radius:var(--rs);color:var(--text);font-size:15px;font-family:var(--font);outline:none;transition:border-color .2s}
.form-field__input::placeholder{color:var(--text-d)}
.form-field__input:focus{border-color:var(--primary)}
.form-field__textarea{resize:vertical;min-height:100px}

/* ===== PRIMARY BUTTON ===== */
.btn-primary{width:100%;padding:16px;border:none;border-radius:var(--rs);background:var(--primary);color:#fff;font-size:16px;font-weight:700;font-family:var(--font);cursor:pointer;transition:opacity .15s,transform .15s;display:flex;align-items:center;justify-content:center}
.btn-primary:active{transform:scale(.98);opacity:.85}
.btn-primary--outline{background:transparent;border:1.5px solid var(--primary);color:var(--primary-light)}

/* ===== PAGE SCREENS (settings, contacts, etc.) ===== */
.page-screen{display:flex;flex-direction:column;background:var(--bg)}
.page-header{display:flex;align-items:center;gap:12px;padding:16px;padding-top:calc(16px + var(--st));border-bottom:1px solid var(--border-l)}
.page-header .screen-back{position:static;flex-shrink:0}
.page-header__title{font-size:20px;font-weight:700}
.page-body{flex:1;padding:20px 16px;padding-bottom:calc(20px + var(--sb));overflow-y:auto}
.page-body__desc{font-size:14px;color:var(--text-m);line-height:1.6;margin-bottom:20px}

/* ===== SETTINGS LIST ===== */
.settings-list{display:flex;flex-direction:column;gap:2px}
.settings-item{display:flex;align-items:center;gap:14px;padding:16px;background:var(--bg-card);border:none;border-radius:var(--rs);color:var(--text);font-size:15px;font-weight:500;font-family:var(--font);cursor:pointer;transition:background .15s;margin-bottom:8px;text-align:left;width:100%}
.settings-item svg{width:20px;height:20px;color:var(--text-m);flex-shrink:0}
.settings-item span{flex:1}
.settings-item__arrow{width:16px;height:16px;color:var(--text-d)}
.settings-item:active{background:rgba(108,99,255,.08)}
.settings-item--logout{color:var(--red)}
.settings-item--logout svg{color:var(--red)}

/* ===== TOGGLE SWITCHES ===== */
.toggle-item{display:flex;align-items:center;justify-content:space-between;padding:16px;background:var(--bg-card);border-radius:var(--rs);margin-bottom:8px;cursor:pointer;font-size:15px;font-weight:500;position:relative}
.toggle-input{opacity:0;width:0;height:0;position:absolute}
.toggle-slider{width:48px;height:28px;background:var(--text-d);border-radius:14px;position:relative;transition:background .3s;flex-shrink:0}
.toggle-slider::after{content:'';position:absolute;top:3px;left:3px;width:22px;height:22px;border-radius:50%;background:#fff;transition:transform .3s}
.toggle-input:checked+.toggle-slider{background:var(--primary)}
.toggle-input:checked+.toggle-slider::after{transform:translateX(20px)}

/* ===== PROFILE ===== */
.profile-avatar-section{display:flex;flex-direction:column;align-items:center;gap:10px;margin-bottom:28px}
.profile-avatar{width:80px;height:80px;border-radius:50%;background:var(--primary);display:flex;align-items:center;justify-content:center;font-size:28px;font-weight:700;color:#fff}
.profile-avatar-edit{font-size:13px;color:var(--primary-light);background:none;border:none;cursor:pointer;font-family:var(--font);font-weight:600}

/* ===== CONTACTS LIST ===== */
.contacts-list{display:flex;flex-direction:column;gap:10px;margin-bottom:20px}
.contact-card{display:flex;align-items:center;gap:14px;padding:16px;background:var(--bg-card);border-radius:var(--rs);border:1px solid var(--border)}
.contact-card__avatar{width:44px;height:44px;border-radius:50%;background:var(--primary);display:flex;align-items:center;justify-content:center;font-size:16px;font-weight:700;color:#fff;flex-shrink:0}
.contact-card__info{flex:1;min-width:0}
.contact-card__name{font-size:15px;font-weight:600;display:block}
.contact-card__phone{font-size:13px;color:var(--text-m);display:block}
.contact-card__rel{font-size:11px;color:var(--text-d);display:block;margin-top:2px}
.contact-card__actions{display:flex;gap:8px}
.contact-card__btn{width:34px;height:34px;border-radius:50%;border:1px solid var(--border);background:transparent;color:var(--text-m);display:flex;align-items:center;justify-content:center;cursor:pointer}
.contact-card__btn svg{width:16px;height:16px}
.contact-card__btn--delete{color:var(--red);border-color:rgba(255,61,113,.2)}
.contact-card__btn--delete:active{background:rgba(255,61,113,.1)}

/* ===== STAR RATING ===== */
.star-rating{display:flex;gap:8px;margin-top:4px}
.star{font-size:28px;background:none;border:none;color:var(--text-d);cursor:pointer;transition:color .15s;padding:0}
.star.active,.star:hover{color:var(--yellow)}

/* ===== SHARE CONTACT LIST (modal) ===== */
.share-contact-list{display:flex;flex-direction:column;gap:10px}
.share-contact-item{display:flex;align-items:center;gap:14px;padding:14px;background:var(--bg-card);border-radius:var(--rs);cursor:pointer;border:1px solid var(--border);transition:border-color .2s}
.share-contact-item:active{border-color:var(--primary)}
.share-contact-item__avatar{width:40px;height:40px;border-radius:50%;background:var(--primary);display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:700;color:#fff;flex-shrink:0}
.share-contact-item__name{font-size:15px;font-weight:500;flex:1}
.share-contact-item__action{font-size:13px;color:var(--primary-light);font-weight:600}

/* ===== SHARE BANNER ===== */
.share-banner{position:absolute;top:calc(70px + var(--st));left:16px;right:16px;z-index:1000;display:flex;align-items:center;gap:12px;padding:12px 16px;background:rgba(22,22,37,.9);backdrop-filter:blur(16px);border:1px solid var(--border);border-radius:var(--rs);box-shadow:var(--shadow)}
.share-banner__icon svg{width:20px;height:20px}
.share-banner__info{flex:1;display:flex;flex-direction:column}
.share-banner__name{font-size:14px;font-weight:600}
.share-banner__status{font-size:12px;color:var(--text-m)}
.share-banner__stop{padding:6px 14px;border:1px solid var(--red);border-radius:8px;background:transparent;color:var(--red);font-size:13px;font-weight:600;font-family:var(--font);cursor:pointer}

/* ===== MAIN APP ===== */
.app{position:relative;width:100%;height:100%;overflow:hidden}

/* ===== TOP BAR ===== */
.topbar{position:absolute;top:0;left:0;right:0;z-index:1000;display:flex;align-items:center;gap:10px;padding:12px 16px;padding-top:calc(12px + var(--st));pointer-events:none}
.topbar>*{pointer-events:auto}
.topbar__avatar{width:40px;height:40px;border-radius:50%;background:var(--primary);border:none;color:#fff;font-size:14px;font-weight:700;font-family:var(--font);display:flex;align-items:center;justify-content:center;cursor:pointer;flex-shrink:0;transition:opacity .2s}
.topbar__avatar:active{opacity:.8}
.topbar__search{flex:1;position:relative}
.topbar__search-input{width:100%;padding:12px 40px 12px 16px;background:rgba(22,22,37,.8);backdrop-filter:blur(16px);border:1px solid var(--border);border-radius:var(--rs);color:var(--text);font-size:15px;font-family:var(--font);outline:none;transition:border-color .2s}
.topbar__search-input::placeholder{color:var(--text-d)}
.topbar__search-input:focus{border-color:var(--primary)}
.topbar__clear{position:absolute;right:6px;top:50%;transform:translateY(-50%);width:30px;height:30px;border-radius:50%;border:none;background:transparent;color:var(--text-d);display:flex;align-items:center;justify-content:center;cursor:pointer}
.topbar__clear svg{width:14px;height:14px}

/* ===== SEARCH SUGGESTIONS ===== */
.search-suggestions{position:absolute;top:calc(64px + var(--st));left:66px;right:16px;z-index:1001;background:var(--bg-card);border:1px solid var(--border);border-radius:var(--rs);box-shadow:var(--shadow);overflow:hidden;display:none;max-height:320px;overflow-y:auto}
.search-suggestions.active{display:block}
.suggestion{display:flex;align-items:center;gap:12px;padding:13px 16px;cursor:pointer;transition:background .15s;border-bottom:1px solid var(--border-l)}
.suggestion:last-child{border-bottom:none}
.suggestion:hover,.suggestion:active{background:rgba(108,99,255,.08)}
.suggestion__icon{width:34px;height:34px;border-radius:50%;background:rgba(108,99,255,.1);display:flex;align-items:center;justify-content:center;flex-shrink:0;font-size:15px}
.suggestion__text{display:flex;flex-direction:column;min-width:0}
.suggestion__name{font-size:14px;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.suggestion__address{font-size:12px;color:var(--text-m);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.suggestion--loading{pointer-events:none;padding:16px}

/* ===== MAP ===== */
.map{position:absolute;inset:0;z-index:1}
.leaflet-control-zoom{display:none!important}
.leaflet-control-attribution{font-size:9px!important;background:rgba(10,10,20,.7)!important;color:var(--text-d)!important}
.leaflet-control-attribution a{color:var(--text-m)!important}

/* ===== BOTTOM SHEET ===== */
.bottom-sheet{position:absolute;bottom:calc(64px + var(--sb));left:0;right:0;z-index:1000;background:var(--bg-card);border-radius:var(--r) var(--r) 0 0;padding:0 20px 24px;box-shadow:0 -8px 40px rgba(0,0,0,.5);will-change:transform}
.bottom-sheet.hidden{display:none}
.bottom-sheet__handle{width:42px;height:4px;border-radius:2px;background:rgba(255,255,255,.2);margin:14px auto 20px;cursor:grab;-webkit-tap-highlight-color:transparent}
.bottom-sheet__handle::before{content:'';display:block;width:80px;height:32px;position:absolute;top:0;left:50%;transform:translateX(-50%)}
.bottom-sheet__title{font-size:20px;font-weight:700;margin-bottom:6px}
.bottom-sheet__desc{font-size:14px;color:var(--text-m);line-height:1.5;margin-bottom:14px;white-space:pre-line;max-height:120px;overflow-y:auto}
.bottom-sheet__desc:empty{display:none}
.bottom-sheet__meta{display:flex;align-items:center;gap:20px;margin-bottom:22px}
.bottom-sheet__meta-item{display:flex;align-items:center;gap:6px;font-size:14px;color:var(--text-m)}
.bottom-sheet__meta-item svg{width:16px;height:16px;color:var(--text-d)}
.bottom-sheet__cta{width:100%;padding:16px;border:none;border-radius:var(--rs);background:var(--primary);color:#fff;font-size:16px;font-weight:700;font-family:var(--font);cursor:pointer;transition:opacity .15s,transform .15s}
.bottom-sheet__cta:active{transform:scale(.98);opacity:.85}

/* ===== CRIME MARKERS ===== */
.crime-marker{transition:transform .15s ease}
.crime-marker:hover{transform:scale(1.2);z-index:999!important}

/* ===== ROUTE PANEL ===== */
.route-panel{position:absolute;bottom:calc(64px + var(--sb));left:0;right:0;z-index:1001;background:var(--bg);border-top:1px solid var(--border);border-radius:var(--r) var(--r) 0 0;padding:20px 16px 20px;box-shadow:0 -8px 40px rgba(0,0,0,.5);display:none}
.route-panel.active{display:block}
.route-panel__handle{width:42px;height:4px;border-radius:2px;background:rgba(255,255,255,.2);margin:12px auto 8px;cursor:grab}
.route-panel__header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}
.route-panel__title{font-size:20px;font-weight:700}
.route-panel__close{width:36px;height:36px;border-radius:50%;border:none;background:var(--bg-card);color:var(--text);display:flex;align-items:center;justify-content:center;cursor:pointer}
.route-panel__close svg{width:18px;height:18px}
.route-panel__options{display:flex;flex-direction:column;gap:12px}
.route-panel__start{display:flex;align-items:center;justify-content:center;gap:8px;width:100%;padding:14px;margin-top:14px;border:none;border-radius:var(--rs);background:var(--primary);color:#fff;font-size:16px;font-weight:700;font-family:var(--font);cursor:pointer;transition:opacity .2s,max-height .2s;opacity:0;max-height:0;overflow:hidden;padding:0;margin:0;pointer-events:none;touch-action:manipulation;-webkit-tap-highlight-color:transparent;position:relative;z-index:10}
.route-panel__start.visible{opacity:1;max-height:60px;padding:14px;margin-top:14px;pointer-events:auto}
.route-panel__start:active{transform:scale(.98);opacity:.85}
.route-panel__start svg{width:18px;height:18px}
.route-card{display:flex;align-items:center;gap:16px;padding:16px;background:var(--bg-card);border:1px solid var(--border);border-radius:var(--rs);cursor:pointer;transition:border-color .2s,transform .15s}
.route-card:active{transform:scale(.98)}
.route-card--selected{border-color:var(--primary-light)!important;box-shadow:0 0 16px rgba(108,99,255,.2)}
.route-card--recommended{border-color:var(--green);box-shadow:0 0 20px rgba(0,230,118,.12)}
.route-card--loading{justify-content:center;pointer-events:none;opacity:.7;animation:loadingPulse 1.5s ease-in-out infinite}
.route-card__badge{display:inline-block;padding:2px 8px;border-radius:9999px;font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.5px;margin-bottom:4px}
.route-card__badge--safe{background:rgba(0,230,118,.15);color:var(--green)}
.route-card__badge--fast{background:rgba(108,99,255,.15);color:var(--primary-light)}
.route-card__badge--caution{background:rgba(255,214,0,.15);color:var(--yellow)}
.route-card__badge--danger{background:rgba(255,61,113,.15);color:var(--red)}
.route-card__safety{width:48px;height:48px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:20px;font-weight:700;flex-shrink:0}
.route-card__safety--high{background:rgba(0,230,118,.15);color:var(--green);box-shadow:0 0 12px rgba(0,230,118,.2)}
.route-card__safety--medium{background:rgba(255,214,0,.15);color:var(--yellow)}
.route-card__safety--low{background:rgba(255,61,113,.15);color:var(--red)}
.route-card__info{flex:1}
.route-card__name{font-size:14px;font-weight:600;margin-bottom:2px}
.route-card__meta{font-size:13px;color:var(--text-m)}
.route-card__arrow{width:20px;height:20px;color:var(--text-d)}

/* ===== FULL-SCREEN DIRECTIONS PAGE ===== */
.directions-page{position:fixed;inset:0;z-index:1100;background:var(--bg);display:flex;flex-direction:column;visibility:hidden;opacity:0;pointer-events:none;transition:opacity .25s ease,visibility .25s ease}
.directions-page.active{visibility:visible;opacity:1;pointer-events:auto}

/* Header */
.directions-page__header{display:flex;align-items:center;gap:12px;padding:16px;padding-top:calc(16px + var(--st));border-bottom:1px solid var(--border-l);flex-shrink:0}
.directions-page__back{width:40px;height:40px;border-radius:50%;border:1px solid var(--border);background:transparent;color:var(--text);display:flex;align-items:center;justify-content:center;cursor:pointer;flex-shrink:0}
.directions-page__back svg{width:20px;height:20px}
.directions-page__title-group{flex:1;min-width:0}
.directions-page__title{font-size:18px;font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.directions-page__subtitle{font-size:12px;color:var(--text-m);display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.directions-page__end{padding:8px 18px;border-radius:var(--rs);border:none;background:var(--red);color:#fff;font-size:13px;font-weight:700;font-family:var(--font);cursor:pointer;flex-shrink:0;transition:opacity .15s}
.directions-page__end:active{opacity:.8}

/* Summary bar */
.directions-page__summary{display:flex;align-items:center;justify-content:space-around;padding:16px 20px;border-bottom:1px solid var(--border-l);flex-shrink:0}
.directions-page__stat{display:flex;flex-direction:column;align-items:center;gap:4px}
.directions-page__stat-value{font-size:22px;font-weight:800;color:var(--text)}
.directions-page__stat-value--time{color:var(--green)}
.directions-page__stat-label{font-size:11px;color:var(--text-d);text-transform:uppercase;letter-spacing:.5px;font-weight:600}
.directions-page__stat-divider{width:1px;height:36px;background:var(--border)}
.directions-page__safety{display:flex;align-items:center;justify-content:center;width:44px;height:44px;border-radius:50%}
.directions-page__safety--high{background:rgba(0,230,118,.15)}
.directions-page__safety--medium{background:rgba(255,214,0,.15)}
.directions-page__safety--low{background:rgba(255,61,113,.15)}
.directions-page__safety-score{font-size:20px;font-weight:800}

/* Hero maneuver */
.directions-page__hero{display:flex;align-items:center;gap:16px;padding:20px;margin:16px;background:var(--primary);border-radius:var(--rs);flex-shrink:0}
.directions-page__hero-icon{width:52px;height:52px;flex-shrink:0;display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,.15);border-radius:50%}
.directions-page__hero-icon svg{width:28px;height:28px;color:#fff}
.directions-page__hero-info{flex:1;min-width:0}
.directions-page__hero-instruction{display:block;font-size:18px;font-weight:700;color:#fff;line-height:1.3}
.directions-page__hero-dist{display:block;font-size:14px;color:rgba(255,255,255,.65);margin-top:4px}

/* Step list */
.directions-page__steps{flex:1;overflow-y:auto;padding:0 16px 16px}
.dir-step{display:flex;align-items:flex-start;gap:14px;padding:16px 0;border-bottom:1px solid var(--border-l);position:relative}
.dir-step:last-child{border-bottom:none}
.dir-step__number{width:28px;height:28px;flex-shrink:0;display:flex;align-items:center;justify-content:center;border-radius:50%;background:var(--bg-card);border:1px solid var(--border);font-size:12px;font-weight:700;color:var(--text-m)}
.dir-step__icon{width:36px;height:36px;flex-shrink:0;display:flex;align-items:center;justify-content:center;background:var(--bg-card);border-radius:50%;color:var(--text-m)}
.dir-step__icon svg{width:20px;height:20px}
.dir-step__icon--arrive{background:rgba(0,230,118,.15);color:var(--green)}
.dir-step__icon--depart{background:rgba(108,99,255,.15);color:var(--primary-light)}
.dir-step__body{flex:1;min-width:0}
.dir-step__instruction{font-size:15px;font-weight:500;color:var(--text);line-height:1.4}
.dir-step__meta{display:flex;align-items:center;gap:10px;margin-top:4px}
.dir-step__dist{font-size:13px;color:var(--text-d)}
.dir-step__street{font-size:12px;color:var(--text-m);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}

/* Timeline connector */
.dir-step::before{content:'';position:absolute;left:17px;top:44px;bottom:0;width:2px;background:var(--border)}
.dir-step:last-child::before{display:none}

/* Footer */
.directions-page__footer{flex-shrink:0;padding:12px 16px;padding-bottom:calc(12px + var(--sb));border-top:1px solid var(--border-l)}
.directions-page__map-btn{display:flex;align-items:center;justify-content:center;gap:8px;width:100%;padding:14px;border:1px solid var(--primary);border-radius:var(--rs);background:transparent;color:var(--primary-light);font-size:15px;font-weight:600;font-family:var(--font);cursor:pointer;transition:background .15s}
.directions-page__map-btn:active{background:rgba(108,99,255,.1)}
.directions-page__map-btn svg{width:18px;height:18px}

/* ===== BUILDING FOOTPRINTS ===== */
.building-layer path{pointer-events:none}

/* ===== FAB BUTTONS ===== */
.report-fab{position:absolute;bottom:calc(140px + var(--sb));right:16px;z-index:999;width:44px;height:44px;border-radius:50%;border:1px solid var(--border);background:rgba(22,22,37,.85);backdrop-filter:blur(12px);color:var(--yellow);cursor:pointer;box-shadow:var(--shadow);display:flex;align-items:center;justify-content:center;transition:transform .15s}
.report-fab:active{transform:scale(.9);background:var(--primary)}
.report-fab svg{width:20px;height:20px}
.locate-fab{position:absolute;bottom:calc(84px + var(--sb));right:16px;z-index:999;width:44px;height:44px;border-radius:50%;border:1px solid var(--border);background:rgba(22,22,37,.85);backdrop-filter:blur(12px);color:var(--text);display:flex;align-items:center;justify-content:center;cursor:pointer;box-shadow:var(--shadow);transition:transform .15s,background .2s}
.locate-fab:active{transform:scale(.9);background:var(--primary);color:#fff}
.locate-fab svg{width:20px;height:20px}

/* ===== BOTTOM NAV ===== */
.bottom-nav{position:absolute;bottom:0;left:0;right:0;z-index:1000;display:flex;align-items:stretch;justify-content:space-around;height:calc(64px + var(--sb));padding-bottom:var(--sb);background:rgba(22,22,37,.95);backdrop-filter:blur(16px);border-top:1px solid var(--border)}
.bottom-nav__item{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:3px;background:none;border:none;color:var(--text-d);font-size:10px;font-weight:500;font-family:var(--font);cursor:pointer;transition:color .2s;padding:8px 0;position:relative}
.bottom-nav__item svg{width:22px;height:22px;transition:color .2s}
.bottom-nav__item--active{color:var(--primary-light)}
.bottom-nav__item--active svg{color:var(--primary-light)}
.bottom-nav__item:active:not(.bottom-nav__item--sos){color:var(--text)}
.bottom-nav__item--sos{color:var(--red)}
.bottom-nav__item--sos svg{width:24px;height:24px;color:var(--red)}
.bottom-nav__item--sos span{color:var(--red)}
.bottom-nav__sos-ring{position:absolute;top:4px;left:50%;transform:translateX(-50%);width:42px;height:42px;border-radius:50%;border:2px solid var(--red);opacity:.3;animation:sosPulse 2s ease-out infinite}
@keyframes sosPulse{0%{transform:translateX(-50%) scale(1);opacity:.6}100%{transform:translateX(-50%) scale(1.4);opacity:0}}

/* ===== MODALS ===== */
.modal-overlay{position:fixed;inset:0;z-index:2000;background:rgba(10,10,20,.85);backdrop-filter:blur(12px);display:flex;align-items:flex-end;justify-content:center;opacity:0;pointer-events:none;transition:opacity .3s ease}
.modal-overlay.active{opacity:1;pointer-events:auto}
.modal{width:100%;max-width:420px;background:var(--bg);border:1px solid var(--border);border-radius:var(--r) var(--r) 0 0;padding:24px 20px calc(24px + var(--sb));transform:translateY(30px);transition:transform .35s ease}
.modal-overlay.active .modal{transform:translateY(0)}
.modal__header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
.modal__title{font-size:20px;font-weight:700}
.modal__close{width:36px;height:36px;border-radius:50%;border:none;background:var(--bg-card);color:var(--text);display:flex;align-items:center;justify-content:center;cursor:pointer}
.modal__close svg{width:18px;height:18px}
.modal__desc{font-size:14px;color:var(--text-m);line-height:1.5;margin-bottom:20px}

/* ===== REPORT GRID ===== */
.report-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
.report-option{display:flex;flex-direction:column;align-items:center;gap:8px;padding:16px 8px;background:var(--bg-card);border:1px solid var(--border);border-radius:var(--rs);cursor:pointer;transition:border-color .2s,transform .15s}
.report-option:active{transform:scale(.95)}
.report-option:hover{border-color:var(--yellow);box-shadow:0 0 16px rgba(255,214,0,.1)}
.report-option__icon{font-size:28px}
.report-option__label{font-size:11px;font-weight:500;color:var(--text-m);text-align:center;line-height:1.3}
.report-confirm{display:none;text-align:center;padding:24px 0 8px}
.report-confirm.active{display:block;animation:fadeSlideUp .4s ease forwards}
.report-confirm__icon{font-size:40px;display:block;margin-bottom:12px}
.report-confirm__text{font-size:15px;color:var(--green);font-weight:500}

/* ===== SOS MODAL ===== */
.modal--sos .modal__title{color:var(--red)}
.sos-content{text-align:center}
.sos-type-btn{padding:6px 12px;border-radius:8px;border:1px solid var(--border);background:var(--bg-card);color:var(--text-m);font-size:12px;font-weight:600;font-family:var(--font);cursor:pointer;transition:all .15s}
.sos-type-btn.active{border-color:var(--red);background:rgba(255,61,113,.12);color:var(--red)}
.sos-type-btn:hover{border-color:var(--red)}
.sos-countdown{margin:16px 0}
.sos-countdown__number{display:inline-flex;align-items:center;justify-content:center;width:80px;height:80px;border-radius:50%;border:3px solid var(--red);font-size:36px;font-weight:700;color:var(--red);animation:countdownPulse 1s ease-in-out infinite}
@keyframes countdownPulse{0%,100%{box-shadow:0 0 0 0 rgba(255,61,113,.4)}50%{box-shadow:0 0 0 12px rgba(255,61,113,0)}}
.sos-countdown__label{display:block;margin-top:8px;font-size:14px;color:var(--text-m)}

/* ===== SOS SWIPE SLIDER ===== */
.sos-swipe{margin:20px 0 16px;user-select:none;-webkit-user-select:none}
.sos-swipe__track{position:relative;width:100%;height:60px;border-radius:30px;background:rgba(255,61,113,.1);border:2px solid rgba(255,61,113,.3);overflow:hidden;display:flex;align-items:center}
.sos-swipe__thumb{position:relative;z-index:3;width:52px;height:52px;margin-left:4px;border-radius:50%;background:var(--red);display:flex;align-items:center;justify-content:center;cursor:grab;flex-shrink:0;box-shadow:0 2px 12px rgba(255,61,113,.4);touch-action:none;will-change:transform}
.sos-swipe__thumb:active{cursor:grabbing}
.sos-swipe__thumb svg{width:22px;height:22px;color:#fff}
.sos-swipe__label{position:absolute;left:0;right:0;text-align:center;font-size:15px;font-weight:600;color:rgba(255,61,113,.7);pointer-events:none;z-index:1;letter-spacing:.3px;animation:swipeHint 2s ease-in-out infinite}
.sos-swipe__fill{position:absolute;top:0;left:0;height:100%;width:0;background:rgba(255,61,113,.15);z-index:0;border-radius:30px;pointer-events:none}
@keyframes swipeHint{0%,100%{opacity:.7}50%{opacity:1}}
.sos-content__text{font-size:14px;color:var(--text-m);line-height:1.5;margin-bottom:20px}
.sos-contacts{display:flex;flex-direction:column;gap:10px;margin-bottom:20px}
.sos-contact{display:flex;align-items:center;gap:12px;padding:12px 14px;background:var(--bg-card);border-radius:var(--rs);text-align:left}
.sos-contact__avatar{width:40px;height:40px;border-radius:50%;background:var(--primary);display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:700;color:#fff;flex-shrink:0}
.sos-contact__info{display:flex;flex-direction:column}
.sos-contact__name{font-size:14px;font-weight:600}
.sos-contact__number{font-size:12px;color:var(--text-m)}
.sos-sent{display:none;text-align:center;padding:20px 0}
.sos-sent.active{display:block;animation:fadeSlideUp .4s ease forwards}
.sos-sent__icon{font-size:40px;display:block;margin-bottom:12px}
.sos-sent__text{font-size:15px;color:var(--green);font-weight:500}

/* ===== BUTTONS ===== */
.btn{display:inline-flex;align-items:center;justify-content:center;padding:14px 24px;border:none;border-radius:var(--rs);font-size:15px;font-weight:600;font-family:var(--font);cursor:pointer;transition:transform .15s,opacity .2s}
.btn:active{transform:scale(.97)}
.btn--danger{background:var(--red);color:#fff;box-shadow:0 4px 16px rgba(255,61,113,.3)}
.btn--ghost{background:transparent;color:var(--text-m);border:1px solid var(--border)}
.btn--full{width:100%;margin-bottom:10px}

/* ===== SIDE DRAWER ===== */
.drawer-overlay{position:fixed;inset:0;z-index:1500;background:rgba(10,10,20,.6);opacity:0;pointer-events:none;transition:opacity .3s ease}
.drawer-overlay.active{opacity:1;pointer-events:auto}
.drawer{position:fixed;top:0;left:-300px;bottom:0;z-index:1501;width:300px;background:var(--bg);border-right:1px solid var(--border);display:flex;flex-direction:column;transition:left .3s ease;padding-top:var(--st)}
.drawer.active{left:0}
.drawer__header{padding:24px 20px;display:flex;align-items:center;gap:14px;border-bottom:1px solid var(--border-l)}
.drawer__avatar{width:48px;height:48px;border-radius:50%;background:var(--primary);display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:700;color:#fff;flex-shrink:0}
.drawer__user-info{display:flex;flex-direction:column}
.drawer__user-name{font-size:16px;font-weight:700}
.drawer__user-email{font-size:12px;color:var(--text-m)}
.drawer__links{list-style:none;padding:12px 0;flex:1}
.drawer__link{display:flex;align-items:center;gap:14px;padding:14px 20px;font-size:15px;font-weight:500;color:var(--text-m);text-decoration:none;transition:background .15s,color .15s}
.drawer__link:hover,.drawer__link--active{background:rgba(108,99,255,.08);color:var(--text)}
.drawer__link--active{color:var(--primary-light)}
.drawer__link svg{width:20px;height:20px}
.drawer__link--logout{color:var(--red)}
.drawer__footer{padding:16px 20px;border-top:1px solid var(--border-l)}
.drawer__version{font-size:11px;color:var(--text-d);margin-top:8px}

/* ===== LEAFLET OVERRIDES ===== */
.user-marker,.poi-marker,.report-marker,.dest-marker{background:none!important;border:none!important}
.leaflet-popup-content-wrapper{background:var(--bg-card)!important;color:var(--text)!important;border-radius:var(--rs)!important;border:1px solid var(--border)!important;box-shadow:var(--shadow)!important}
.leaflet-popup-tip{background:var(--bg-card)!important}
.leaflet-popup-close-button{color:var(--text-m)!important}

/* ===== TOAST ===== */
.toast{position:fixed;bottom:calc(100px + var(--sb));left:50%;transform:translateX(-50%) translateY(80px);z-index:9999;padding:12px 24px;background:var(--bg-card);border:1px solid var(--border);border-radius:var(--rs);font-size:14px;font-weight:500;color:var(--green);box-shadow:var(--shadow);opacity:0;transition:transform .3s ease,opacity .3s ease;pointer-events:none;white-space:nowrap}
.toast.active{transform:translateX(-50%) translateY(0);opacity:1}

/* ===== UTILITY ===== */
@keyframes fadeSlideUp{0%{opacity:0;transform:translateY(12px)}100%{opacity:1;transform:translateY(0)}}
@keyframes loadingPulse{0%,100%{opacity:.5}50%{opacity:.8}}
@media(prefers-reduced-motion:reduce){*,*::before,*::after{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important}}
